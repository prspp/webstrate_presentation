<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sketchup Tool</title>
<style>
    body {
        font-family: Arial, sans-serif;
    }
    .content-zone {
        width: 800px;
        height: 600px;
        border: 2px solid #ccc;
        position: relative;
        margin: 20px auto;
        padding: 20px;
        background-color: #f9f9f9;
    }
    .text-box {
        border: 2px solid #000;
        position: absolute;
        padding: 10px;
        cursor: move;
        background-color: #fff;
    }
    .image-box {
        position: absolute;
        cursor: move;
    }
    .drawing-canvas {
        display: flex;
        justify-content: center;
        z-index: 0;
    }
</style>
</head>
<body>
<div id="container">
    <div class="content-zone" id="content-zone-0">
        <canvas class="drawing-canvas" width="800" height="600"></canvas>
    </div>
</div>

<button onclick="addContentZone()">Add Content Zone</button>
<button onclick="addTextBox()">Add Text Box</button>
<button onclick="addImage()">Add Image</button>
<button onclick="toggleDrawingMode()">Toggle Drawing Mode</button>

<script>
    let currentZIndex = 1;
    let isDrawing = false;
    let isDrawingMode = false;
    let startX, startY;
    let currentContentZone = document.getElementById('content-zone-0');

    function addContentZone() {
        const container = document.getElementById('container');
        const newContentZone = document.createElement('div');
        const newCanvas = document.createElement('canvas');
        newCanvas.className = 'drawing-canvas';
        newCanvas.width = 800;
        newCanvas.height = 600;
        newContentZone.className = 'content-zone';
        newContentZone.appendChild(newCanvas);
        container.appendChild(newContentZone);
        newContentZone.addEventListener('mousedown', selectContentZone);
        newContentZone.addEventListener('mousedown', handleMouseDown);
        newContentZone.addEventListener('mousemove', handleMouseMove);
        newContentZone.addEventListener('mouseup', handleMouseUp);
        newContentZone.addEventListener('mouseleave', handleMouseLeave);
    }

    function selectContentZone(event) {
        if (event.target.classList.contains('content-zone')) {
            currentContentZone = event.target;
        } else if (event.target.parentElement.classList.contains('content-zone')) {
            currentContentZone = event.target.parentElement;
        }
    }

    function addTextBox() {
        const textBox = document.createElement('div');
        textBox.className = 'text-box';
        textBox.style.top = '50px';
        textBox.style.left = '50px';
        textBox.contentEditable = true;
        textBox.style.zIndex = currentZIndex++;
        currentContentZone.appendChild(textBox);
    }

    function addImage() {
        const imageUrl = prompt("Enter image URL:");
        if (imageUrl) {
            const imageBox = document.createElement('img');
            imageBox.src = imageUrl;
            imageBox.className = 'image-box';
            imageBox.style.top = '50px';
            imageBox.style.left = '50px';
            imageBox.style.width = '200px'; // Change width as desired
            imageBox.style.zIndex = currentZIndex++;
            currentContentZone.appendChild(imageBox);
        }
    }

    function toggleDrawingMode() {
        isDrawingMode = !isDrawingMode;
        const canvas = currentContentZone.querySelector('.drawing-canvas');
        canvas.style.zIndex = isDrawingMode ? currentZIndex++ : 0;
        if (isDrawingMode) {
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseleave', stopDrawing);
        } else {
            canvas.removeEventListener('mousedown', startDrawing);
            canvas.removeEventListener('mousemove', draw);
            canvas.removeEventListener('mouseup', stopDrawing);
            canvas.removeEventListener('mouseleave', stopDrawing);
        }
    }

    function startDrawing(event) {
        isDrawing = true;
        const canvas = event.target;
        const ctx = canvas.getContext('2d');
        ctx.beginPath();
        startX = event.offsetX;
        startY = event.offsetY;
        ctx.moveTo(startX, startY);
    }

    function draw(event) {
        if (!isDrawing) return;
        const canvas = event.target;
        const ctx = canvas.getContext('2d');
        const currentX = event.offsetX;
        const currentY = event.offsetY;
        ctx.lineTo(currentX, currentY);
        ctx.stroke();
    }

    function stopDrawing() {
        isDrawing = false;
    }

    function handleMouseDown(event) {
        if (!isDrawingMode && (event.target.classList.contains('text-box') || event.target.classList.contains('image-box'))) {
            activeElement = event.target;
            initialX = event.clientX - activeElement.getBoundingClientRect().left;
            initialY = event.clientY - activeElement.getBoundingClientRect().top;
            offsetX = event.clientX;
            offsetY = event.clientY;
        }
    }

    function handleMouseMove(event) {
        if (activeElement) {
            const current_left = event.clientX - currentContentZone.getBoundingClientRect().left;
            const current_top = event.clientY - currentContentZone.getBoundingClientRect().top;

            const rec = activeElement.getBoundingClientRect();
            if (0 < current_left && current_left + rec.width < currentContentZone.getBoundingClientRect().right - currentContentZone.getBoundingClientRect().left
                && 0 < current_top && current_top + rec.height < currentContentZone.getBoundingClientRect().bottom - currentContentZone.getBoundingClientRect().top) {
                activeElement.style.left = current_left + 'px';
                activeElement.style.top = current_top + 'px';
            }
        }
    }

    function handleMouseUp() {
        activeElement = null;
    }

    function handleMouseLeave() {
        activeElement = null;
    }

    document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('.content-zone').forEach(zone => {
            zone.addEventListener('mousedown', selectContentZone);
            zone.addEventListener('mousedown', handleMouseDown);
            zone.addEventListener('mousemove', handleMouseMove);
            zone.addEventListener('mouseup', handleMouseUp);
            zone.addEventListener('mouseleave', handleMouseLeave);
        });
    });
</script>
</body>
</html>
